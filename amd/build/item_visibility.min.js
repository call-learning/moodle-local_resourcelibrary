define("local_resourcelibrary/item_visibility",["exports","core/ajax","core/notification"],(function(_exports,_ajax,_notification){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}
/**
   * Manage which courses are shown in the catalogue.
   *
   * @module     local_resourcelibrary/item_visibility
   * @copyright  2023 Bas Brands <bas@sonsbeekmedia.nl>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_ajax=_interopRequireDefault(_ajax),_notification=_interopRequireDefault(_notification);class ItemVisibility{constructor(){this.changeToButtons(),this.addEventListeners()}changeToButtons(){document.querySelectorAll('a[data-action="hidefromcatalogue"], a[data-action="showincatalogue"]').forEach((element=>{const dataset=element.dataset,button=document.createElement("span");element.classList.forEach((cssclass=>{button.classList.add(cssclass)})),Object.keys(dataset).forEach((key=>{button.dataset[key]=dataset[key]})),button.classList.add("btn-link"),button.setAttribute("role","button"),button.innerHTML=element.innerHTML,element.parentNode.replaceChild(button,element)}))}addEventListeners(){document.addEventListener("click",(event=>{const hidefromcatalogue=event.target.closest('[data-action="hidefromcatalogue"]');hidefromcatalogue&&(event.preventDefault(),this.hideFromCatalogue(hidefromcatalogue));const showincatalogue=event.target.closest('[data-action="showincatalogue"]');showincatalogue&&(event.preventDefault(),this.showInCatalogue(showincatalogue))}))}hideFromCatalogue(element){const params={id:element.dataset.id,itemid:element.dataset.itemid,itemtype:element.dataset.itemtype,visibility:1};this.sendRequest(params)}showInCatalogue(element){const params={id:element.dataset.id,itemid:element.dataset.itemid,itemtype:element.dataset.itemtype,visibility:0};this.sendRequest(params)}sendRequest(params){const items={items:[params]};_ajax.default.call([{methodname:"local_resourcelibrary_set_items_visibility",args:items,done:data=>{data.returneditems?this.updateButtons(data.returneditems):_notification.default.exception(data)}}])}updateButtons(items){items.forEach((item=>{const itemid=item.itemid,itemtype=item.itemtype,visibility=item.visibility,showInCatalogueButton=document.querySelector(`[data-action="showincatalogue"][data-itemid="${itemid}"][data-itemtype="${itemtype}"]`),hideFromCatalogueButton=document.querySelector(`[data-action="hidefromcatalogue"][data-itemid="${itemid}"][data-itemtype="${itemtype}"]`);0===visibility?(showInCatalogueButton&&showInCatalogueButton.classList.add("d-none"),hideFromCatalogueButton&&(hideFromCatalogueButton.classList.remove("d-none"),hideFromCatalogueButton.classList.add("blink"),setTimeout((()=>{hideFromCatalogueButton.classList.remove("blink")}),1e3))):1===visibility&&(showInCatalogueButton&&(showInCatalogueButton.classList.remove("d-none"),showInCatalogueButton.classList.add("blink"),setTimeout((()=>{showInCatalogueButton.classList.remove("blink")}),1e3)),hideFromCatalogueButton&&hideFromCatalogueButton.classList.add("d-none"))}))}}_exports.default={init:()=>{new ItemVisibility}};return _exports.default}));

//# sourceMappingURL=item_visibility.min.js.map